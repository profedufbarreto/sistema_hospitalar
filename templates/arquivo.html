<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Arquivo | Histórico de Altas</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    </head>
<body>
<header class="main-header">
    <h2>Dashboard | PEP</h2> 
    <nav style="display: flex; align-items: center;">
        
        <div class="theme-switcher">
            <input type="checkbox" id="theme-toggle" title="Alternar Modo de Visualização">
            <label for="theme-toggle" class="theme-icon-label"></label>
        </div>
        
        <a href="{{ url_for('dashboard') }}" class="active">Dashboard</a>
        <a href="{{ url_for('prontuario') }}">Prontuário</a>
        <a href="{{ url_for('pacientes') }}">Pacientes</a> 
        <a href="{{ url_for('estoque') }}">Estoque</a>
        <a href="{{ url_for('conversor') }}">Conversor</a> 
        <a href="{{ url_for('arquivo') }}">Arquivo</a> 
        
        {% if session.get('nivel') in ['admin', 'tecnico'] %}
            <a href="{{ url_for('gerenciar_usuarios') }}">Usuários</a>
        {% endif %}
        
        <a href="{{ url_for('logout') }}" class="btn-logout">Sair</a>
    </nav>
</header>

    <main class="arquivo-container">
        {% if mensagem %}
            <div class="mensagem-sucesso">{{ mensagem }}</div>
        {% endif %}
        
        <h3>Pacientes com Alta Registrada</h3>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome do Paciente</th>
                    <th>Entrada</th>
                    <th>Alta</th>
                    <th>Motivo/Procedimento</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for paciente in pacientes %}
                <tr>
                    <td>{{ paciente.id }}</td>
                    <td>{{ paciente.nome }}</td>
                    <td>{{ paciente.data_entrada.strftime('%d/%m/%Y') }}</td>
                    <td>{{ paciente.data_baixa.strftime('%d/%m/%Y') }}</td>
                    <td>{{ paciente.procedimento | truncate(50) }}</td>
                    <td>
                        <a href="{{ url_for('detalhes_prontuario', paciente_id=paciente.id) }}" class="btn-detalhes">Ver Detalhes</a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="6">Nenhum paciente encontrado no arquivo de altas.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </main>
</body>
</html>